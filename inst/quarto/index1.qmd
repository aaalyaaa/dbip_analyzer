---
title: "DB-IP Data Visualization"
format: html
---

```{r}
data("demo", package = "dbipAnalyzer")

# Определяем путь для сохранения
data_dir <- "data"
if (!dir.exists(data_dir)) {
  dir.create(data_dir, recursive = TRUE)
}

data_path <- file.path(data_dir, "demo.parquet")

# Сохраняем как parquet
arrow::write_parquet(demo, data_path)

# Загружаем данные
data <- arrow::read_parquet(data_path)

data <- dbipAnalyzer:::load_processed_data(data_path)
```
### Статистика
```{r}
print(data_path)
print(data)
```
```{r}
#| echo: false
stats <-  invisible(dbipAnalyzer:::get_data_stats(data))
map_data <- head(data, 100000)  
data("demo", package = "dbipAnalyzer")
print(data)
ip_map <- dbipAnalyzer:::create_ip_map(map_data, 100000)
as_chart <- dbipAnalyzer:::create_as_org_chart(data, top_n = 15)
data_table <- dbipAnalyzer:::create_table(data, n = 200)
```
### Карта распределения IP - адресов (для первых 10)
```{r}
#| echo: false
ip_map
```
### AS организаций по количеству IP-диапазонов
```{r}
#| echo: false
print(as_chart)
```
### Таблица данных DB-IP
```{r}
#| echo: false
data_table
```

